<!doctype html>
<html>
  <head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <link rel="stylesheet" href="style.css">
  </head>
  <body>

	<div class="tile">
	<br> ....
	<br> tete
	</div>

	<script src="sjcl.js"></script> <!-- crypto library -->
	<script>
		var seed = 0;
		var tile = [];
		function newTile() {
			tile = [];
			for (i = 0; i < 256; i++) {
				let x = [];
				for (j = 0; j < 256; j++) {
					x.push("__");
				}
				tile.push(x);
			}
		}
		newTile();
		function renderTile() {
			function renderX(X_content, x) {
				function renderY(Y_content, y) {
					x_html = x_html+Y_content;
				}
				let x_html = "";
				tile[x].forEach(renderY);
				html = html+x_html+"<br>";
			}

			let html = "";
			tile.forEach(renderX);
			$( ".tile" ).html(html);
		}

		function genTile(seed) {
			let out = sjcl.hash.sha256.hash(seed); //hashes seed into bitArray
			let hash = sjcl.codec.hex.fromBits(out); //convert bitArray to hexadecimal
			console.log( hash );

			let tree_count = hash.substring(0, 1);
			tree_count = parseInt(tree_count, 16);
			console.log( tree_count );

			function tree_place(count) {
				//reset tile
				newTile();
				for (i = 0; i < count; i++) {
					let x = hash.substring(64-4*i-2, 64-4*i); //out of last 4 hex digits, takes the last 2
					x = parseInt(x, 16);
					console.log( x );
					let y = hash.substring(64-4*i-4, 64-4*i-2); //out of above 4 hex digits, takes the first 2
					y = parseInt(y, 16);
					console.log( y );

					//place it
					tile[x][y] = "<span style='tree' >[]</span>";
				}
				renderTile();
			}

			tree_place(tree_count);
		}
		$( document ).ready(function() {
			genTile(seed);
			$( ".tile" ).click(function() {
				seed = seed + 1;
				genTile(seed);
			});
		});

	</script>
  </body>
</html>
